<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>3D Periodic Table - Solid Elements</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { 
            margin: 0; 
            overflow: hidden; 
            background-color: #f1f5f9; 
            background-image: url('inmeg/background.jpg'); 
            background-size: cover; 
            background-position: center; 
            background-repeat: no-repeat;
            background-attachment: fixed;
            touch-action: none; 
            font-family: 'Segoe UI', sans-serif; 
        }
        #canvas-container { 
            position: fixed; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%; 
            z-index: 0;
        }
        
        /* Element button styling */
        .element-btn {
            aspect-ratio: 1;
            transition: all 0.1s ease;
            position: relative;
            overflow: hidden;
            min-height: 44px;
            min-width: 44px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1), 0 1px 2px rgba(0,0,0,0.05);
        }
        .element-btn:active { transform: scale(0.9); box-shadow: inset 0 2px 4px rgba(0,0,0,0.2); }
        .element-number { position: absolute; top: 1px; left: 2px; font-size: 0.45rem; opacity: 0.8; color: rgba(255,255,255,0.9); }
        .element-symbol { font-weight: bold; font-size: 0.75rem; line-height: 1; color: white; }
        .element-name { font-size: 0.45rem; opacity: 0.9; margin-top: 1px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; width: 100%; padding: 0 1px; color: rgba(255,255,255,0.95); }
        
        /* Category Colors */
        .cat-nonmetal { background: linear-gradient(135deg, #ec4899, #db2777); }
        .cat-alkaline { background: linear-gradient(135deg, #f59e0b, #ea580c); }
        .cat-post-transition { background: linear-gradient(135deg, #f87171, #ef4444); }
        .cat-metalloid { background: linear-gradient(135deg, #a78bfa, #8b5cf6); }
        .cat-transition { background: linear-gradient(135deg, #6366f1, #4f46e5); }
        .cat-noble { background: linear-gradient(135deg, #22d3ee, #06b6d4); }
        .cat-other { background: linear-gradient(135deg, #64748b, #475569); }

        /* Gray Board */
        .gray-board {
            background: rgba(255, 255, 255, 0.85);
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06), inset 0 1px 0 rgba(255,255,255,0.8);
            border-radius: 12px;
            padding: 8px;
            backdrop-filter: blur(8px);
        }
        
        /* Glass UI */
        .glass-panel {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 -4px 6px -1px rgba(0, 0, 0, 0.05), 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }
        
        @keyframes slideInRight {
            from { transform: translateX(20px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes slideInUp {
            from { transform: translateY(100%); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        /* ‚ú® ‡∏õ‡∏∏‡πà‡∏° AR ‡πÉ‡∏´‡∏°‡πà - Futuristic Gradient */
        .ar-button {
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 50%, #2563eb 100%);
            background-size: 200% 200%;
            animation: gradientShift 3s ease infinite;
            color: white;
            border: none;
            border-radius: 50px;
            padding: 8px 16px;
            font-size: 11px;
            font-weight: bold;
            letter-spacing: 0.5px;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(79, 70, 229, 0.4), 0 0 0 2px rgba(255,255,255,0.3) inset;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            gap: 6px;
            pointer-events: auto;
        }
        
        .ar-button:hover {
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 6px 20px rgba(79, 70, 229, 0.6), 0 0 20px rgba(124, 58, 237, 0.4);
        }
        
        .ar-button:active {
            transform: translateY(0) scale(0.95);
        }
        
        /* ‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Å‡∏ï‡πå‡πÅ‡∏™‡∏á‡∏ß‡∏¥‡πà‡∏á */
        .ar-button::after {
            content: '';
            position: absolute;
            top: -50%;
            left: -100%;
            width: 60%;
            height: 200%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            transform: rotate(25deg);
            transition: 0.5s;
            animation: shimmer 2.5s infinite;
        }
        
        @keyframes shimmer {
            0% { left: -100%; }
            20% { left: 200%; }
            100% { left: 200%; }
        }
        
        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .ar-icon {
            font-size: 14px;
            filter: drop-shadow(0 0 4px rgba(255,255,255,0.8));
        }
        
        /* ‡∏õ‡∏∏‡πà‡∏°‡∏õ‡∏¥‡∏î‡∏ó‡∏µ‡πà‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô */
        .close-btn {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: rgba(0,0,0,0.05);
            border: 1px solid rgba(0,0,0,0.1);
            color: #64748b;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            font-size: 12px;
        }
        
        .close-btn:hover {
            background: #ef4444;
            color: white;
            border-color: #dc2626;
            transform: rotate(90deg);
        }
        
        .loader {
            border: 2px solid rgba(0,0,0,0.1);
            border-radius: 50%;
            border-top: 2px solid #3b82f6;
            width: 24px; height: 24px;
            animation: spin 0.8s linear infinite;
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            display: none; z-index: 50;
        }
        @keyframes spin { 0% { transform: translate(-50%, -50%) rotate(0deg); } 100% { transform: translate(-50%, -50%) rotate(360deg); } }
        
        @media (max-width: 640px) {
            .element-btn { min-height: 40px; min-width: 40px; }
            .element-symbol { font-size: 0.7rem; }
            .element-name { font-size: 0.4rem; }
            .gray-board { padding: 6px; border-radius: 8px; }
            .ar-button { padding: 6px 12px; font-size: 10px; }
        }
    </style>

    <script type="importmap">
    {
        "imports": {
            "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
            "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
        }
    }
    </script>
</head>
<body>

<div id="canvas-container"></div>
<div id="loader" class="loader"></div>

<!-- UI Layer -->
<div class="absolute inset-0 pointer-events-none flex flex-col justify-between z-10">
    
    <!-- Header -->
    <div class="pointer-events-auto p-3 flex justify-between items-center bg-white/70 backdrop-blur-md border-b border-white/20 shadow-sm">
        <div class="text-slate-800 flex items-center gap-2">
            <span class="text-xl">‚öõÔ∏è</span>
            <div>
                <h1 class="text-sm font-bold leading-none text-slate-900">‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ò‡∏≤‡∏ï‡∏∏</h1>
                <p class="text-[10px] opacity-70 text-slate-600">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ò‡∏≤‡∏ï‡∏∏‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡πÇ‡∏°‡πÄ‡∏î‡∏• 3D</p>
            </div>
        </div>
        
        <!-- ‡∏õ‡∏∏‡πà‡∏° AR ‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡πÉ‡∏´‡∏°‡πà -->
        <button id="arBtn" class="ar-button">
            <span class="ar-icon">ü•Ω</span>
            <span>AR Mode</span>
        </button>
    </div>

    <!-- Desktop Info - ‡∏ã‡πà‡∏≠‡∏ô‡πÑ‡∏ß‡πâ‡∏ï‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô (hidden) -->
    <div id="desktop-info" class="hidden absolute right-3 top-14 w-56 glass-panel rounded-xl p-4 text-slate-800 pointer-events-auto shadow-2xl z-20">
        <div class="flex justify-between items-start mb-2">
            <div>
                <h2 id="info-symbol" class="text-4xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-600 to-purple-600 leading-none"></h2>
                <h3 id="info-name" class="text-sm font-medium text-slate-700 mt-1"></h3>
            </div>
            <button onclick="closeInfo()" class="close-btn" title="‡∏õ‡∏¥‡∏î">
                ‚úï
            </button>
        </div>
        <div id="info-category" class="inline-block px-2 py-1 rounded-full text-[10px] mb-2 font-medium text-white shadow-sm"></div>
        
        <div class="space-y-2 text-xs">
            <p id="info-desc" class="text-slate-600 leading-relaxed"></p>
            <div class="bg-slate-50/80 rounded-lg p-2 border border-slate-100">
                <ul id="info-details" class="text-slate-500 space-y-1 text-[11px]"></ul>
            </div>
        </div>
    </div>

    <!-- Periodic Table Grid -->
    <div class="pointer-events-auto p-2">
        <div class="gray-board max-w-[280px] mx-auto">
            <div class="grid grid-cols-4 gap-1" id="periodic-grid">
                <!-- 12 elements generated by JS -->
            </div>
        </div>
    </div>
</div>

<!-- Mobile Bottom Sheet - ‡∏ã‡πà‡∏≠‡∏ô‡πÑ‡∏ß‡πâ‡∏ï‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô -->
<div id="mobile-sheet" class="fixed inset-x-0 bottom-0 glass-panel rounded-t-2xl p-4 text-slate-800 transform translate-y-full transition-transform duration-300 z-30 lg:hidden shadow-[0_-10px_40px_rgba(0,0,0,0.2)]">
    <div class="w-12 h-1.5 bg-slate-300/50 rounded-full mx-auto mb-3"></div>
    
    <div class="flex justify-between items-start mb-2">
        <div class="flex items-center gap-3">
            <h2 id="mobile-symbol" class="text-3xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-600 to-purple-600"></h2>
            <div>
                <h3 id="mobile-name" class="text-sm font-semibold text-slate-800"></h3>
                <span id="mobile-category" class="text-[10px] text-slate-500"></span>
            </div>
        </div>
        <button onclick="closeMobileSheet()" class="close-btn" title="‡∏õ‡∏¥‡∏î">
            ‚úï
        </button>
    </div>
    
    <p id="mobile-desc" class="text-xs text-slate-600 mb-3 leading-relaxed"></p>
    
    <div class="bg-slate-50/80 rounded-lg p-3 border border-slate-100">
        <div id="mobile-details" class="text-[11px] text-slate-600 grid grid-cols-3 gap-2"></div>
    </div>
</div>

<script type="module">
import * as THREE from 'three';
import { OrbitControls } from 'three/addons/controls/OrbitControls.js';
import { GLTFLoader } from 'three/addons/loaders/GLTFLoader.js';

const elementsData = {
    'Ag': { number: 47, name: '‡πÄ‡∏á‡∏¥‡∏ô', modelFile: 'inmeg/silver.glb', category: 'transition', 
           desc: '‡πÇ‡∏•‡∏´‡∏∞‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡∏™‡∏µ‡∏Ç‡∏≤‡∏ß‡πÄ‡∏á‡∏≤‡∏á‡∏≤‡∏° ‡∏ô‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô‡πÅ‡∏•‡∏∞‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î ‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡πÅ‡∏•‡∏∞‡∏≠‡∏¥‡πÄ‡∏•‡πá‡∏Å‡∏ó‡∏£‡∏≠‡∏ô‡∏¥‡∏Å‡∏™‡πå',  details: ['Z: 47', '‡∏°‡∏ß‡∏•: 107.87', '‡∏à‡∏∏‡∏î‡∏´‡∏•‡∏≠‡∏°: 961.8¬∞C'] },
    'Au': { number: 79, name: '‡∏ó‡∏≠‡∏á‡∏Ñ‡∏≥', modelFile: 'inmeg/gold.glb', category: 'transition', 
           desc: '‡πÇ‡∏•‡∏´‡∏∞‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡∏™‡∏µ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á‡∏ô‡∏ß‡∏• ‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏î‡∏≠‡∏≠‡∏Å‡∏ã‡∏¥‡πÄ‡∏î‡∏ä‡∏±‡∏ô ‡πÉ‡∏ä‡πâ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡πÅ‡∏•‡∏∞‡∏™‡∏≥‡∏£‡∏≠‡∏á‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡∏£‡∏≤',  details: ['Z: 79', '‡∏°‡∏ß‡∏•: 196.97', '‡∏à‡∏∏‡∏î‡∏´‡∏•‡∏≠‡∏°: 1064¬∞C'] },
    'Mg': { number: 12, name: '‡πÅ‡∏°‡πá‡∏Å‡∏ô‡∏¥‡πÄ‡∏ã‡∏µ‡∏¢‡∏°', modelFile: 'inmeg/magnesium.glb', category: 'alkaline', 
           desc: '‡πÇ‡∏•‡∏´‡∏∞‡πÄ‡∏ö‡∏≤‡∏™‡∏µ‡∏Ç‡∏≤‡∏ß‡πÄ‡∏á‡∏¥‡∏ô ‡∏ï‡∏¥‡∏î‡πÑ‡∏ü‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢‡πÉ‡∏ô‡∏≠‡∏≤‡∏Å‡∏≤‡∏® ‡πÄ‡∏õ‡πá‡∏ô‡∏ò‡∏≤‡∏ï‡∏∏‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πà‡∏≠‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢ ‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏≠‡∏∏‡∏ï‡∏™‡∏≤‡∏´‡∏Å‡∏£‡∏£‡∏°‡πÇ‡∏•‡∏´‡∏∞‡∏ú‡∏™‡∏°‡πÅ‡∏•‡∏∞‡∏¢‡∏≤',  details: ['Z: 12', '‡∏°‡∏ß‡∏•: 24.305', '‡∏à‡∏∏‡∏î‡∏´‡∏•‡∏≠‡∏°: 650¬∞C'] },
    'S': { number: 16, name: '‡∏Å‡∏≥‡∏°‡∏∞‡∏ñ‡∏±‡∏ô', modelFile: 'inmeg/sulfur.glb', category: 'nonmetal', 
         desc: '‡∏ò‡∏≤‡∏ï‡∏∏‡πÑ‡∏°‡πà‡πÄ‡∏õ‡πá‡∏ô‡πÇ‡∏•‡∏´‡∏∞‡∏™‡∏µ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á ‡∏°‡∏µ‡∏Å‡∏•‡∏¥‡πà‡∏ô‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÑ‡∏Ç‡πà‡πÄ‡∏ô‡πà‡∏≤ ‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏≠‡∏∏‡∏ï‡∏™‡∏≤‡∏´‡∏Å‡∏£‡∏£‡∏°‡∏¢‡∏≤‡∏á ‡∏î‡∏¥‡∏ô‡∏õ‡∏∑‡∏ô ‡πÅ‡∏•‡∏∞‡∏¢‡∏≤‡∏Ü‡πà‡∏≤‡πÄ‡∏ä‡∏∑‡πâ‡∏≠',  details: ['Z: 16', '‡∏°‡∏ß‡∏•: 32.06', '‡∏à‡∏∏‡∏î‡∏´‡∏•‡∏≠‡∏°: 115.21¬∞C'] },
    'Al': { number: 13, name: '‡∏≠‡∏•‡∏π‡∏°‡∏¥‡πÄ‡∏ô‡∏µ‡∏¢‡∏°', modelFile: 'inmeg/aluminium.glb', category: 'post-transition', 
            desc: '‡πÇ‡∏•‡∏´‡∏∞‡πÄ‡∏ö‡∏≤ ‡∏ó‡∏ô‡∏ï‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏Å‡∏±‡∏î‡∏Å‡∏£‡πà‡∏≠‡∏ô ‡∏ô‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô‡πÅ‡∏•‡∏∞‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡∏î‡∏µ', details: ['Z: 13', '‡∏°‡∏ß‡∏•: 26.98', '‡∏à‡∏∏‡∏î‡∏´‡∏•‡∏≠‡∏°: 660¬∞C'] },
    'Ga': { number: 31, name: '‡πÅ‡∏Å‡∏•‡πÄ‡∏•‡∏µ‡∏¢‡∏°', modelFile: 'inmeg/gallium.glb', category: 'post-transition', 
        desc: '‡πÇ‡∏•‡∏´‡∏∞‡∏™‡∏µ‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏ß‡∏ß‡∏ß‡∏≤‡∏ß ‡∏´‡∏•‡∏≠‡∏°‡πÄ‡∏´‡∏•‡∏ß‡∏ó‡∏µ‡πà‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢ (29.76¬∞C) ‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡πÄ‡∏ã‡∏°‡∏¥‡∏Ñ‡∏≠‡∏ô‡∏î‡∏±‡∏Å‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÅ‡∏•‡∏∞‡πÇ‡∏ã‡∏•‡∏≤‡∏£‡πå‡πÄ‡∏ã‡∏•‡∏•‡πå',  details: ['Z: 31', '‡∏°‡∏ß‡∏•: 69.723', '‡∏à‡∏∏‡∏î‡∏´‡∏•‡∏≠‡∏°: 29.76¬∞C'] },
    'Sb': { number: 51, name: '‡∏û‡∏•‡∏ß‡∏á', modelFile: 'inmeg/antimony.glb', category: 'metalloid', 
    desc: '‡∏ò‡∏≤‡∏ï‡∏∏‡∏Å‡∏∂‡πà‡∏á‡πÇ‡∏•‡∏´‡∏∞‡∏™‡∏µ‡πÄ‡∏á‡∏¥‡∏ô‡∏≠‡∏°‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô ‡πÄ‡∏õ‡∏£‡∏≤‡∏∞‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡∏£‡∏≤‡∏∞‡∏á‡πà‡∏≤‡∏¢ ‡πÉ‡∏ä‡πâ‡∏ú‡∏™‡∏°‡πÇ‡∏•‡∏´‡∏∞‡πÉ‡∏´‡πâ‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏£‡∏á‡πÅ‡∏•‡∏∞‡πÉ‡∏ô‡∏≠‡∏∏‡∏ï‡∏™‡∏≤‡∏´‡∏Å‡∏£‡∏£‡∏°‡πÅ‡∏ö‡∏ï‡πÄ‡∏ï‡∏≠‡∏£‡∏µ‡πà',   details: ['Z: 51', '‡∏°‡∏ß‡∏•: 121.760', '‡∏à‡∏∏‡∏î‡∏´‡∏•‡∏≠‡∏°: 630.63¬∞C'] },
    'Ca': { number: 20, name: '‡πÅ‡∏Ñ‡∏•‡πÄ‡∏ã‡∏µ‡∏¢‡∏°', modelFile: 'inmeg/calcium.glb', category: 'alkaline', 
            desc: '‡πÇ‡∏•‡∏´‡∏∞‡∏™‡∏µ‡πÄ‡∏ó‡∏≤‡∏≠‡πà‡∏≠‡∏ô ‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏£‡∏á ‡∏û‡∏ö‡∏°‡∏≤‡∏Å‡πÉ‡∏ô‡∏Å‡∏£‡∏∞‡∏î‡∏π‡∏Å‡πÅ‡∏•‡∏∞‡∏´‡∏¥‡∏ô‡∏õ‡∏π‡∏ô', details: ['Z: 20', '‡∏°‡∏ß‡∏•: 40.08', '‡∏à‡∏∏‡∏î‡∏´‡∏•‡∏≠‡∏°: 842¬∞C'] },
    'Fe': { number: 26, name: '‡πÄ‡∏´‡∏•‡πá‡∏Å', modelFile: 'inmeg/iron.glb', category: 'transition', 
            desc: '‡πÇ‡∏•‡∏´‡∏∞‡∏ó‡∏£‡∏≤‡∏ô‡∏ã‡∏¥‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç ‡πÅ‡∏°‡πà‡πÄ‡∏´‡∏•‡πá‡∏Å‡πÑ‡∏î‡πâ ‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏£‡∏á', details: ['Z: 26', '‡∏°‡∏ß‡∏•: 55.85', '‡∏à‡∏∏‡∏î‡∏´‡∏•‡∏≠‡∏°: 1538¬∞C'] },
    'Cu': { number: 29, name: '‡∏ó‡∏≠‡∏á‡πÅ‡∏î‡∏á', modelFile: 'inmeg/copper.glb', category: 'transition', 
            desc: '‡πÇ‡∏•‡∏´‡∏∞‡∏™‡∏µ‡πÅ‡∏î‡∏á‡∏≠‡∏¥‡∏ê ‡∏ô‡∏≥‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô‡∏î‡∏µ‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°', details: ['Z: 29', '‡∏°‡∏ß‡∏•: 63.55', '‡∏à‡∏∏‡∏î‡∏´‡∏•‡∏≠‡∏°: 1085¬∞C'] },
    'Zn': { number: 30, name: '‡∏™‡∏±‡∏á‡∏Å‡∏∞‡∏™‡∏µ', modelFile: 'inmeg/zinc.glb', category: 'post-transition', 
            desc: '‡πÇ‡∏•‡∏´‡∏∞‡∏™‡∏µ‡πÄ‡∏á‡∏¥‡∏ô‡∏≠‡∏°‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô ‡πÉ‡∏ä‡πâ‡∏ä‡∏∏‡∏ö‡∏Å‡∏±‡∏ô‡∏™‡∏ô‡∏¥‡∏° ‡∏ú‡∏™‡∏°‡∏ó‡∏≠‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á', details: ['Z: 30', '‡∏°‡∏ß‡∏•: 65.38', '‡∏à‡∏∏‡∏î‡∏´‡∏•‡∏≠‡∏°: 419.5¬∞C'] },
    'Pb': {  number: 82, name: '‡∏ï‡∏∞‡∏Å‡∏±‡πà‡∏ß', modelFile: 'inmeg/lead.glb', category: 'post-transition', 
    desc: '‡πÇ‡∏•‡∏´‡∏∞‡∏´‡∏ô‡∏±‡∏Å‡∏™‡∏µ‡πÄ‡∏ó‡∏≤‡πÄ‡∏á‡∏¥‡∏ô ‡∏≠‡πà‡∏≠‡∏ô‡∏ô‡∏∏‡πà‡∏° ‡∏ó‡∏ô‡∏ó‡∏≤‡∏ô‡∏ï‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏Å‡∏±‡∏î‡∏Å‡∏£‡πà‡∏≠‡∏ô ‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡πÅ‡∏ö‡∏ï‡πÄ‡∏ï‡∏≠‡∏£‡∏µ‡πà‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏£‡∏±‡∏á‡∏™‡∏µ',  details: ['Z: 82', '‡∏°‡∏ß‡∏•: 207.2', '‡∏à‡∏∏‡∏î‡∏´‡∏•‡∏≠‡∏°: 327.5¬∞C'] 
}
};

let camera, scene, renderer, controls, loader;
let currentModel = null;

function init() {
    scene = new THREE.Scene();
    // ‡πÑ‡∏°‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î background color ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏´‡πá‡∏ô‡∏†‡∏≤‡∏û‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏Ç‡∏≠‡∏á body
    // scene.background = null;
    // ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ fog ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏ö‡∏î‡∏ö‡∏±‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á
    // scene.fog = null;

    camera = new THREE.PerspectiveCamera(50, window.innerWidth / window.innerHeight, 0.1, 100);
    camera.position.set(0, 0, 5);

    renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
    renderer.setSize(window.innerWidth, window.innerHeight);
    renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
    renderer.shadowMap.enabled = true;
    renderer.shadowMap.type = THREE.PCFSoftShadowMap;
    // ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ alpha ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÇ‡∏õ‡∏£‡πà‡∏á‡πÉ‡∏™
    renderer.setClearColor(0x000000, 0);
    document.getElementById('canvas-container').appendChild(renderer.domElement);

    controls = new OrbitControls(camera, renderer.domElement);
    controls.enableDamping = true;
    controls.dampingFactor = 0.05;
    controls.minDistance = 2;
    controls.maxDistance = 10;
    controls.enablePan = false;

    scene.add(new THREE.AmbientLight(0xffffff, 0.7));
    const dirLight = new THREE.DirectionalLight(0xffffff, 1.2);
    dirLight.position.set(3, 5, 5);
    dirLight.castShadow = true;
    dirLight.shadow.mapSize.width = 1024;
    dirLight.shadow.mapSize.height = 1024;
    scene.add(dirLight);
    
    const fillLight = new THREE.DirectionalLight(0xe0f2fe, 0.5);
    fillLight.position.set(-3, 0, -5);
    scene.add(fillLight);

    loader = new GLTFLoader();
    generateTable();
    window.addEventListener('resize', onWindowResize);
    
    // AR Button Event
    document.getElementById('arBtn').addEventListener('click', async (e) => {
        e.stopPropagation();
        if (!navigator.xr) { 
            alert('‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö WebXR / AR'); 
            return; 
        }
        try {
            const supported = await navigator.xr.isSessionSupported('immersive-ar');
            if (supported) {
                alert('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏õ‡∏¥‡∏î‡πÇ‡∏´‡∏°‡∏î AR...\n(‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏ö‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠‡∏ó‡∏µ‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö)');
            } else {
                alert('‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö AR');
            }
        } catch(e) {
            alert('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô AR ‡πÑ‡∏î‡πâ');
        }
    });
    
    animate();
}

function generateTable() {
    const grid = document.getElementById('periodic-grid');
    Object.keys(elementsData).forEach(symbol => {
        const el = elementsData[symbol];
        const btn = document.createElement('button');
        btn.className = `element-btn cat-${el.category} rounded flex flex-col items-center justify-center pointer-events-auto`;
        btn.onclick = (e) => {
            e.stopPropagation();
            selectElement(symbol);
        };
        
        btn.innerHTML = `
            <span class="element-number">${el.number}</span>
            <span class="element-symbol">${symbol}</span>
            <span class="element-name">${el.name}</span>
        `;
        grid.appendChild(btn);
    });
}

function selectElement(symbol) {
    const data = elementsData[symbol];
    if (!data) return;

    // Update Desktop Info
    const desktopInfo = document.getElementById('desktop-info');
    document.getElementById('info-symbol').textContent = symbol;
    document.getElementById('info-name').textContent = data.name;
    
    const categoryEl = document.getElementById('info-category');
    categoryEl.textContent = getCategoryTh(data.category);
    categoryEl.className = `inline-block px-2 py-1 rounded-full text-[10px] mb-2 font-medium text-white shadow-sm cat-${data.category}`;
    
    document.getElementById('info-desc').textContent = data.desc;
    document.getElementById('info-details').innerHTML = data.details.map(d => 
        `<li class="flex items-center gap-1"><span class="text-blue-500">‚Ä¢</span> ${d}</li>`
    ).join('');
    
    // Show Desktop Info with animation
    desktopInfo.classList.remove('hidden');
    desktopInfo.style.animation = 'slideInRight 0.3s ease-out';
    
    // Update Mobile Info
    document.getElementById('mobile-symbol').textContent = symbol;
    document.getElementById('mobile-name').textContent = data.name;
    document.getElementById('mobile-category').textContent = getCategoryTh(data.category);
    document.getElementById('mobile-desc').textContent = data.desc;
    document.getElementById('mobile-details').innerHTML = data.details.map(d => {
        const [label, value] = d.split(':');
        return `<div class="text-center bg-white rounded p-1 shadow-sm"><div class="text-blue-600 font-medium text-[9px]">${label}</div><div class="text-slate-800 font-bold">${value || ''}</div></div>`;
    }).join('');
    
    // Show Mobile Sheet
    if (window.innerWidth < 1024) {
        document.getElementById('mobile-sheet').classList.remove('translate-y-full');
    }
    
    loadModel(data.modelFile);
}

function getCategoryTh(cat) {
    const map = { 'nonmetal': '‡∏≠‡πÇ‡∏•‡∏´‡∏∞', 'noble': '‡πÅ‡∏Å‡πä‡∏™‡∏°‡∏µ‡∏ï‡∏£‡∏∞‡∏Å‡∏π‡∏•', 'alkaline': '‡∏≠‡∏±‡∏•‡∏Ñ‡∏≤‡πÑ‡∏•‡∏ô‡πå', 
                  'metalloid': '‡∏Å‡∏∂‡πà‡∏á‡πÇ‡∏•‡∏´‡∏∞', 'transition': '‡πÇ‡∏•‡∏´‡∏∞‡∏ó‡∏£‡∏≤‡∏ô‡∏ã‡∏¥‡∏ä‡∏±‡∏ô', 'post-transition': '‡πÇ‡∏•‡∏´‡∏∞‡∏´‡∏•‡∏±‡∏á‡∏ó‡∏£‡∏≤‡∏ô‡∏ã‡∏¥‡∏ä‡∏±‡∏ô' };
    return map[cat] || cat;
}

function closeInfo() {
    const el = document.getElementById('desktop-info');
    el.style.animation = 'none';
    setTimeout(() => el.classList.add('hidden'), 10);
}

function closeMobileSheet() {
    document.getElementById('mobile-sheet').classList.add('translate-y-full');
}

function loadModel(filePath) {
    if (currentModel) {
        scene.remove(currentModel);
        currentModel = null;
    }
    document.getElementById('loader').style.display = 'block';
    
    loader.load(filePath, (gltf) => {
        document.getElementById('loader').style.display = 'none';
        currentModel = gltf.scene;
        
        const box = new THREE.Box3().setFromObject(currentModel);
        const center = box.getCenter(new THREE.Vector3());
        const maxDim = Math.max(...box.getSize(new THREE.Vector3()).toArray());
        const scale = 2 / maxDim;
        
        currentModel.scale.setScalar(scale);
        currentModel.position.sub(center.multiplyScalar(scale));
        currentModel.position.y += 0.5;
        
        currentModel.traverse(c => { 
            if(c.isMesh) { 
                c.castShadow = true; 
                c.receiveShadow = true; 
            }
        });
        scene.add(currentModel);
        
        // Entry animation
        let s = 0;
        const entry = setInterval(() => {
            s += 0.1;
            currentModel.scale.setScalar(s * scale);
            currentModel.rotation.y += 0.1;
            if(s >= 1) {
                clearInterval(entry);
                currentModel.rotation.y = 0;
            }
        }, 16);
    }, undefined, (error) => {
        console.error('Error loading model:', error);
        document.getElementById('loader').style.display = 'none';
        
        // Fallback geometry
        const geo = new THREE.IcosahedronGeometry(0.8, 2);
        const mat = new THREE.MeshStandardMaterial({ 
            color: 0x3b82f6, 
            roughness: 0.3, 
            metalness: 0.2,
            emissive: 0x1d4ed8,
            emissiveIntensity: 0.2
        });
        currentModel = new THREE.Mesh(geo, mat);
        scene.add(currentModel);
    });
}

function onWindowResize() {
    camera.aspect = window.innerWidth / window.innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(window.innerWidth, window.innerHeight);
}

function animate() {
    requestAnimationFrame(animate);
    controls.update();
    if (currentModel) currentModel.rotation.y += 0.003;
    renderer.render(scene, camera);
}

// Global functions for onclick handlers
window.closeInfo = closeInfo;
window.closeMobileSheet = closeMobileSheet;

init();
</script>

</body>
</html>